<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Pocket Corridor Table (sd/df)</title>

  <link rel="manifest" href="manifest.json" />
  <meta name="theme-color" content="#0b0f14" />
  <link rel="icon" href="icon-192.png" />
  <link rel="stylesheet" href="styles.css" />
</head>

<body>
  <header>
    <h1>Pocket Corridor Table (sd/df)</h1>
    <p class="sub">PCPT table + corridor calculator (Δ, V, Δop → R, sin²φ, CRS)</p>
  </header>

  <main>
    <!-- 1) Calculator -->
    <section class="card" id="calculator">
      <h2>1) 2×2 Calculator (from the paper)</h2>

      <div class="grid">
        <label for="delta">Δ (eV)
          <input
            id="delta"
            type="text"
            inputmode="decimal"
            lang="en"
            autocomplete="off"
            spellcheck="false"
            placeholder="1.0"
            value="1.0"
          />
        </label>

        <label for="V">V (eV)
          <input
            id="V"
            type="text"
            inputmode="decimal"
            lang="en"
            autocomplete="off"
            spellcheck="false"
            placeholder="0.5"
            value="0.5"
          />
        </label>

        <label for="dop">Δop (eV)
          <input
            id="dop"
            type="text"
            inputmode="decimal"
            lang="en"
            autocomplete="off"
            spellcheck="false"
            placeholder="0.2"
            value="0.2"
          />
        </label>

        <label for="T">T (K) (optional)
          <input
            id="T"
            type="text"
            inputmode="numeric"
            lang="en"
            autocomplete="off"
            spellcheck="false"
            placeholder="300"
            value="300"
          />
        </label>
      </div>

      <button id="calc" type="button">Calculate</button>

      <div class="out" id="out" aria-live="polite"></div>

      <details class="small">
        <summary>Formulas (audit)</summary>
        <pre>
R      = |Δ| / |V|
sin²φ  = 1/2 · (1 − Δ / √(Δ² + 4V²))
Δmix   = √(Δ² + 4V²)
kBT(eV)= 8.617333262e−5 · T

CRS heuristic (editable):
  CRS = 0 if Δop ≥ 0.5 and R ≥ 5
  CRS = 1 if Δop ≥ 0.2 and R ≥ 2
  CRS = 2 if Δop ≥ 0.1 and R ≥ 1
  else CRS = 3
        </pre>
      </details>
    </section>

    <!-- 2) Periodic Table (clickable) -->
    <section class="card" id="ptableCard">
      <h2>2) Periodic Table (click an element)</h2>
      <p class="small">
        Click an element to highlight it in the PCPT table and show its corridor metadata (CRS / DMC / note).
      </p>

      <div id="ptable" class="ptable" aria-label="Periodic table"></div>

      <div id="elementDetails" class="details" aria-live="polite" style="display:none;">
        <h3 id="detailsTitle" style="margin:0 0 8px 0;">Element</h3>
        <div class="small" id="detailsBody"></div>
      </div>
    </section>

    <!-- 3) PCPT table from CSV -->
    <section class="card" id="pcptCsv">
      <h2>3) PCPT by element (CSV)</h2>
      <p class="small">
        File: <code>data/pcpt.csv</code> (symbol, CRS, DMC, note). The table below loads this CSV.
      </p>

      <div class="toolbar">
        <input
          id="filter"
          type="search"
          inputmode="search"
          lang="en"
          autocomplete="off"
          spellcheck="false"
          placeholder="Filter by symbol (e.g., Fe) or DMC (e.g., SOC)"
        />
        <button id="reload" type="button">Reload CSV</button>
      </div>

      <div id="pcptTable"></div>
    </section>

    <!-- 4) Optional cases -->
    <section class="card" id="cases">
      <h2>4) Case dataset (synthesis/complexes) — optional</h2>
      <p class="small">
        File: <code>data/cases.csv</code> with (Δ, V, Δop, θ, observable) to attach real data and generate reports.
      </p>
      <div id="casesTable"></div>
    </section>
  </main>

  <footer class="small">
    <p>
      Offline: this site registers a Service Worker when served over HTTPS (Netlify/GitHub Pages).
      If opened as a local file (file://), the PWA will not install.
    </p>
  </footer>

  <script src="app.js"></script>
</body>
</html>
